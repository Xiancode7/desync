Write-Host 'Loading Optimized Engine...'; $c=[System.Convert]::FromBase64String('PCMNCi5TWU5PUFNJUw0KICAgIFhJQU5DT0RFIFBST0RVQ1QgLSAnRGVzeW5jJw0KDQojPg0KDQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KIyBbS0VZQVVUSCBDT05GSUdVUkFUSU9OXQ0KIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiRLQV9OYW1lID0gImRlc3luYyINCiRLQV9Pd25lcklkID0gIm5aY2QzeDJFWDkiDQokS0FfU2VjcmV0ID0gIjdkMjMyYmVlMmM1NmYzOTdlZmQ3YjU4NWEyMDFhNmNhZTNhOWI3YmNmOGQ3Mjk5YTkzOWU4YWZlYzY3M2IxOGQiDQokS0FfVmVyc2lvbiA9ICIxLjAiDQojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KDQpmdW5jdGlvbiBDYWxsLUtleUF1dGggew0KICAgIHBhcmFtKCR0eXBlLCAkcDFfbiwgJHAxX3YsICRzZXNzaW9uKQ0KICAgICRhcGkgPSAiaHR0cHM6Ly9rZXlhdXRoLndpbi9hcGkvMS4yLz90eXBlPSR0eXBlJm5hbWU9JEtBX05hbWUmb3duZXJpZD0kS0FfT3duZXJJZCZ2ZXI9JEtBX1ZlcnNpb24iDQogICAgaWYgKCRzZXNzaW9uKSB7ICRhcGkgKz0gIiZzZXNzaW9uaWQ9JHNlc3Npb24iIH0NCiAgICBpZiAoJHAxX24pIHsgJGFwaSArPSAiJiRwMV9uPSRwMV92IiB9DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgcmV0dXJuIEludm9rZS1SZXN0TWV0aG9kIC1VcmkgJGFwaSAtTWV0aG9kIEdldA0KICAgIH0NCiAgICBjYXRjaCB7DQogICAgICAgIHJldHVybiBAe3N1Y2Nlc3MgPSAkZmFsc2U7IG1lc3NhZ2UgPSAiQ29ubmVjdGlvbiBFcnJvciIgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gUnVuLUNsZWFuZXIgew0KICAgIFdyaXRlLUhvc3QgImBuW0NMRUFORVJdIFdpcGluZyBFeGVjdXRpb24gSGlzdG9yeS4uLiIgLUZvcmVncm91bmRDb2xvciBNYWdlbnRhDQogICAgDQogICAgIyAxLiBDbGVhciBQb3dlclNoZWxsIEhpc3RvcnkgKEN1cnJlbnQgU2Vzc2lvbikNCiAgICBDbGVhci1IaXN0b3J5DQogICAgDQogICAgIyAyLiBDbGVhciBQU1JlYWRsaW5lIEhpc3RvcnkgRmlsZQ0KICAgIHRyeSB7DQogICAgICAgIGlmIChHZXQtTW9kdWxlIC1MaXN0QXZhaWxhYmxlIFBTUmVhZGxpbmUpIHsNCiAgICAgICAgICAgICRIaXN0b3J5UGF0aCA9IChHZXQtUFNSZWFkbGluZU9wdGlvbikuSGlzdG9yeVNhdmVQYXRoDQogICAgICAgICAgICBpZiAoVGVzdC1QYXRoICRIaXN0b3J5UGF0aCkgeyANCiAgICAgICAgICAgICAgICBSZW1vdmUtSXRlbSAkSGlzdG9yeVBhdGggLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlDQogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiICAgLT4gUG93ZXJTaGVsbCBIaXN0b3J5IERlbGV0ZWQiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBjYXRjaCB7fQ0KDQogICAgIyAzLiBDbGVhciBSZWNlbnQgRmlsZXMgKFRyYWNrcykNCiAgICB0cnkgew0KICAgICAgICBSZW1vdmUtSXRlbSAiJGVudjpBUFBEQVRBXE1pY3Jvc29mdFxXaW5kb3dzXFJlY2VudFwqIiAtRm9yY2UgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUNCiAgICAgICAgV3JpdGUtSG9zdCAiICAgLT4gUmVjZW50IEZpbGVzIENsZWFyZWQiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICB9DQogICAgY2F0Y2gge30NCg0KICAgIFdyaXRlLUhvc3QgIltDTEVBTkVSXSBUcmFja3MgUmVtb3ZlZC4gRXhpdGluZy4uLiIgLUZvcmVncm91bmRDb2xvciBNYWdlbnRhDQogICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgMg0KfQ0KDQpmdW5jdGlvbiBSdW4tT3B0aW1pemF0aW9uIHsNCiAgICBXcml0ZS1Ib3N0ICJgblN0YXJ0aW5nIEZpdmVNIFRydWUgQWxsLUluLU9uZSBPcHRpbWl6YXRpb24uLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbg0KDQogICAgIyBbVVNFUiBDT05GSUdVUkFUSU9OXQ0KICAgICRCQU5EV0lEVEhfTElNSVQgPSAxODAwDQogICAgJE1UVV9TSVpFID0gMTQwMA0KICAgICRDUFVfQ09SRV9NQVNLID0gMw0KDQogICAgIyBbMS8xMF0gU1lTVEVNIENMRUFOVVAgJiBQT1dFUg0KICAgIFdyaXRlLUhvc3QgIlsxLzEwXSBDbGVhbmluZyBTeXN0ZW0gJiBTZXR0aW5nIFBvd2VyLi4uIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgIFJlbW92ZS1JdGVtIC1QYXRoICIkZW52OlRFTVBcKiIgLVJlY3Vyc2UgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIDI+JG51bGwNCiAgICBSZW1vdmUtSXRlbSAtUGF0aCAiQzpcV2luZG93c1xUZW1wXCoiIC1SZWN1cnNlIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSAyPiRudWxsDQogICAgUmVtb3ZlLUl0ZW0gLVBhdGggIkM6XFdpbmRvd3NcUHJlZmV0Y2hcKiIgLVJlY3Vyc2UgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIDI+JG51bGwNCg0KICAgIHBvd2VyY2ZnIC1kdXBsaWNhdGVzY2hlbWUgZTlhNDJiMDItZDVkZi00NDhkLWFhMDAtMDNmMTQ3NDllYjYxIDI+JG51bGwNCiAgICBwb3dlcmNmZyAtc2V0YWN0aXZlIGU5YTQyYjAyLWQ1ZGYtNDQ4ZC1hYTAwLTAzZjE0NzQ5ZWI2MQ0KICAgIGlmICgkTEFTVEVYSVRDT0RFIC1uZSAwKSB7IHBvd2VyY2ZnIC1zZXRhY3RpdmUgOGM1ZTdmZGEtZThiZi00YTk2LTlhODUtYTZlMjNhOGM2MzVjIH0NCg0KICAgICMgWzIvMTBdIFNUQUJJTElUWQ0KICAgIFdyaXRlLUhvc3QgIlsyLzEwXSBEaXNhYmxpbmcgR2FtZURWUiAmIFRocm90dGxpbmcuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgJEdhbWVDb25maWdTdG9yZSA9ICJIS0NVOlxTeXN0ZW1cR2FtZUNvbmZpZ1N0b3JlIg0KICAgIGlmICgtbm90IChUZXN0LVBhdGggJEdhbWVDb25maWdTdG9yZSkpIHsgTmV3LUl0ZW0gLVBhdGggJEdhbWVDb25maWdTdG9yZSAtRm9yY2UgfCBPdXQtTnVsbCB9DQogICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkR2FtZUNvbmZpZ1N0b3JlIC1OYW1lICJHYW1lRFZSX0VuYWJsZWQiIC1WYWx1ZSAwIC1Qcm9wZXJ0eVR5cGUgRFdPUkQgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwNCiAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRHYW1lQ29uZmlnU3RvcmUgLU5hbWUgIkdhbWVEVlJfRlNFQmVoYXZpb3JNb2RlIiAtVmFsdWUgMiAtUHJvcGVydHlUeXBlIERXT1JEIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IE91dC1OdWxsDQogICAgJEdhbWVEVlJQb2xpY3kgPSAiSEtMTTpcU09GVFdBUkVcUG9saWNpZXNcTWljcm9zb2Z0XFdpbmRvd3NcR2FtZURWUiINCiAgICBpZiAoLW5vdCAoVGVzdC1QYXRoICRHYW1lRFZSUG9saWN5KSkgeyBOZXctSXRlbSAtUGF0aCAkR2FtZURWUlBvbGljeSAtRm9yY2UgfCBPdXQtTnVsbCB9DQogICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkR2FtZURWUlBvbGljeSAtTmFtZSAiQWxsb3dHYW1lRFZSIiAtVmFsdWUgMCAtUHJvcGVydHlUeXBlIERXT1JEIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IE91dC1OdWxsDQogICAgJE11bHRpbWVkaWFQYXJhbXMgPSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cTXVsdGltZWRpYVxTeXN0ZW1Qcm9maWxlIg0KICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJE11bHRpbWVkaWFQYXJhbXMgLU5hbWUgIk5ldHdvcmtUaHJvdHRsaW5nSW5kZXgiIC1WYWx1ZSAweGZmZmZmZmZmIC1Qcm9wZXJ0eVR5cGUgRFdPUkQgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwNCiAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRNdWx0aW1lZGlhUGFyYW1zIC1OYW1lICJTeXN0ZW1SZXNwb25zaXZlbmVzcyIgLVZhbHVlIDAgLVByb3BlcnR5VHlwZSBEV09SRCAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbA0KDQogICAgIyBbMy8xMF0gTkVUV09SSw0KICAgIFdyaXRlLUhvc3QgIlszLzEwXSBUdW5pbmcgTmV0d29yayAoVENQL0lQICYgTVRVKS4uLiIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCiAgICAkVGNwUGFyYW1zID0gIkhLTE06XFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxTZXJ2aWNlc1xUY3BpcFxQYXJhbWV0ZXJzIg0KICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJFRjcFBhcmFtcyAtTmFtZSAiRGlzYWJsZVRhc2tPZmZsb2FkIiAtVmFsdWUgMSAtUHJvcGVydHlUeXBlIERXT1JEIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IE91dC1OdWxsDQogICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkVGNwUGFyYW1zIC1OYW1lICJUY3BBY2tGcmVxdWVuY3kiIC1WYWx1ZSAxIC1Qcm9wZXJ0eVR5cGUgRFdPUkQgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwNCiAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRUY3BQYXJhbXMgLU5hbWUgIlRjcE5vRGVsYXkiIC1WYWx1ZSAxIC1Qcm9wZXJ0eVR5cGUgRFdPUkQgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwNCiAgICBuZXRzaCBpbnQgdGNwIHNldCBnbG9iYWwgYXV0b3R1bmluZ2xldmVsPW5vcm1hbCAyPiRudWxsDQogICAgbmV0c2ggaW50IHRjcCBzZXQgZ2xvYmFsIHRpbWVzdGFtcHM9ZGlzYWJsZWQgMj4kbnVsbA0KICAgIEdldC1OZXRBZGFwdGVyIHwgV2hlcmUtT2JqZWN0IHsgJF8uU3RhdHVzIC1lcSAiVXAiIH0gfCBGb3JFYWNoLU9iamVjdCB7IG5ldHNoIGludGVyZmFjZSBpcHY0IHNldCBzdWJpbnRlcmZhY2UgJF8uSW50ZXJmYWNlQWxpYXMgbXR1PSRNVFVfU0laRSBzdG9yZT1wZXJzaXN0ZW50IDI+JG51bGwgfQ0KICAgIA0KICAgICRRb1NGaXZlTSA9ICJIS0xNOlxTT0ZUV0FSRVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93c1xRb1NcRml2ZU0iDQogICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkUW9TRml2ZU0pKSB7IE5ldy1JdGVtIC1QYXRoICRRb1NGaXZlTSAtRm9yY2UgfCBPdXQtTnVsbCB9DQogICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkUW9TRml2ZU0gLU5hbWUgIlRocm90dGxlUmF0ZSIgLVZhbHVlICRCQU5EV0lEVEhfTElNSVQgLVByb3BlcnR5VHlwZSBEV09SRCAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbA0KICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJFFvU0ZpdmVNIC1OYW1lICJQcm90b2NvbCIgLVZhbHVlICIqIiAtUHJvcGVydHlUeXBlIFN0cmluZyAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbA0KDQogICAgIyBbNC8xMF0gRE5TICYgQklUUw0KICAgIFdyaXRlLUhvc3QgIls0LzEwXSBPcHRpbWl6aW5nIEROUyAmIEJhY2tncm91bmQgU2VydmljZXMuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgJEROU0NsaWVudCA9ICJIS0xNOlxTT0ZUV0FSRVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93cyBOVFxETlNDbGllbnQiDQogICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkRE5TQ2xpZW50KSkgeyBOZXctSXRlbSAtUGF0aCAkRE5TQ2xpZW50IC1Gb3JjZSB8IE91dC1OdWxsIH0NCiAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRETlNDbGllbnQgLU5hbWUgIkVuYWJsZU11bHRpY2FzdCIgLVZhbHVlIDAgLVByb3BlcnR5VHlwZSBEV09SRCAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbA0KDQogICAgIyBbNS8xMF0gSU5QVVQgTEFHDQogICAgV3JpdGUtSG9zdCAiWzUvMTBdIFJlZHVjaW5nIElucHV0IExhZy4uLiIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCiAgICAkTW91c2VQYXRoID0gIkhLQ1U6XENvbnRyb2wgUGFuZWxcTW91c2UiDQogICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkTW91c2VQYXRoIC1OYW1lICJNb3VzZVNwZWVkIiAtVmFsdWUgIjAiIC1Qcm9wZXJ0eVR5cGUgU3RyaW5nIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IE91dC1OdWxsDQogICAgY21kIC9jICJiY2RlZGl0IC9zZXQgdXNlcGxhdGZvcm10aWNrIHllcyIgfCBPdXQtTnVsbA0KICAgIGNtZCAvYyAiYmNkZWRpdCAvc2V0IGRpc2FibGVkeW5hbWljdGljayB5ZXMiIHwgT3V0LU51bGwNCg0KICAgICMgWzYvMTBdIFBSSU9SSVRZDQogICAgV3JpdGUtSG9zdCAiWzYvMTBdIFNldHRpbmcgSGlnaCBQcmlvcml0eS4uLiIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCiAgICAkR2FtZXNQcm9maWxlID0gIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXE11bHRpbWVkaWFcU3lzdGVtUHJvZmlsZVxUYXNrc1xHYW1lcyINCiAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRHYW1lc1Byb2ZpbGUgLU5hbWUgIkdQVSBQcmlvcml0eSIgLVZhbHVlIDggLVByb3BlcnR5VHlwZSBEV09SRCAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbA0KICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJEdhbWVzUHJvZmlsZSAtTmFtZSAiUHJpb3JpdHkiIC1WYWx1ZSA2IC1Qcm9wZXJ0eVR5cGUgRFdPUkQgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwNCg0KICAgICMgWzcvMTBdIE5WSURJQQ0KICAgIFdyaXRlLUhvc3QgIls3LzEwXSBBcHBseWluZyBOVklESUEgVHdlYWtzLi4uIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICROdmlkaWFLZXlQYXRoID0gIkhLTE06XFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXENsYXNzXHs0ZDM2ZTk2OC1lMzI1LTExY2UtYmZjMS0wODAwMmJlMTAzMTh9Ig0KICAgICROdmlkaWFBZGFwdGVycyA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggIiROdmlkaWFLZXlQYXRoXCoiIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgV2hlcmUtT2JqZWN0IHsgKCRfLlByb3ZpZGVyTmFtZSAtbGlrZSAiKk5WSURJQSoiKSAtb3IgKCRfLkRyaXZlckRlc2MgLWxpa2UgIipOVklESUEqIikgfQ0KICAgIGlmICgkTnZpZGlhQWRhcHRlcnMpIHsNCiAgICAgICAgZm9yZWFjaCAoJGFkYXB0ZXIgaW4gJE52aWRpYUFkYXB0ZXJzKSB7DQogICAgICAgICAgICAkcGF0aCA9ICRhZGFwdGVyLlBTUGF0aA0KICAgICAgICAgICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiRDNQQ0xhdGVuY3kiIC1WYWx1ZSAwIC1Qcm9wZXJ0eVR5cGUgRFdPUkQgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwNCiAgICAgICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkxPV0xBVEVOQ1kiIC1WYWx1ZSAxIC1Qcm9wZXJ0eVR5cGUgRFdPUkQgLUZvcmNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgT3V0LU51bGwNCiAgICAgICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIlBjaUxhdGVuY3lUaW1lckNvbnRyb2wiIC1WYWx1ZSAyMCAtUHJvcGVydHlUeXBlIERXT1JEIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IE91dC1OdWxsDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAjIFs4LzEwXSBHRU5FUkFURSBMVUENCiAgICBXcml0ZS1Ib3N0ICJbOC8xMF0gR2VuZXJhdGluZyBGaXZlTSBDbGllbnQgQm9vc3QgU2NyaXB0IChMdWEpLi4uIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICRMdWFDb250ZW50ID0gQCINCi0tID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KLS0gWElBTiBGaXZlTSBJTlBVVCAvIE5FVFdPUksgRkVFTElORyBPUFRJTUlaRVIgKEFEVikNCi0tID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KbG9jYWwgRU5BQkxFID0gdHJ1ZQ0KQ2l0aXplbi5DcmVhdGVUaHJlYWQoZnVuY3Rpb24oKQ0KICAgIHdoaWxlIHRydWUgZG8NCiAgICAgICAgaWYgRU5BQkxFIHRoZW4NCiAgICAgICAgICAgIENpdGl6ZW4uV2FpdCgwKQ0KICAgICAgICAgICAgRGlzYWJsZUNvbnRyb2xBY3Rpb24oMCwgMSwgdHJ1ZSkNCiAgICAgICAgICAgIERpc2FibGVDb250cm9sQWN0aW9uKDAsIDIsIHRydWUpDQogICAgICAgICAgICBFbmFibGVDb250cm9sQWN0aW9uKDAsIDEsIHRydWUpDQogICAgICAgICAgICBFbmFibGVDb250cm9sQWN0aW9uKDAsIDIsIHRydWUpDQogICAgICAgICAgICBEaXNhYmxlQ29udHJvbEFjdGlvbigwLCAyNCwgZmFsc2UpDQogICAgICAgICAgICBEaXNhYmxlQ29udHJvbEFjdGlvbigwLCAyNSwgZmFsc2UpDQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIENpdGl6ZW4uV2FpdCgxMDApDQogICAgICAgIGVuZA0KICAgIGVuZA0KZW5kKQ0KQ2l0aXplbi5DcmVhdGVUaHJlYWQoZnVuY3Rpb24oKQ0KICAgIHdoaWxlIHRydWUgZG8NCiAgICAgICAgQ2l0aXplbi5XYWl0KDEpDQogICAgICAgIGxvY2FsIHBlZCA9IFBsYXllclBlZElkKCkNCiAgICAgICAgaWYgSXNQZWRPbkZvb3QocGVkKSB0aGVuDQogICAgICAgICAgICBTZXRQZWRNb3ZlUmF0ZU92ZXJyaWRlKHBlZCwgMS4xMCkNCiAgICAgICAgICAgIFNldFBlZENhblBsYXlBbWJpZW50QW5pbXMocGVkLCBmYWxzZSkNCiAgICAgICAgICAgIFNldFBlZENhblBsYXlBbWJpZW50QmFzZUFuaW1zKHBlZCwgZmFsc2UpDQogICAgICAgIGVuZA0KICAgIGVuZA0KZW5kKQ0KQ2l0aXplbi5DcmVhdGVUaHJlYWQoZnVuY3Rpb24oKQ0KICAgIHdoaWxlIHRydWUgZG8NCiAgICAgICAgQ2l0aXplbi5XYWl0KDApDQogICAgICAgIGxvY2FsIHBlZCA9IFBsYXllclBlZElkKCkNCiAgICAgICAgbG9jYWwgbmV0SWQgPSBOZXR3b3JrR2V0TmV0d29ya0lkRnJvbUVudGl0eShwZWQpDQogICAgICAgIE5ldHdvcmtSZXF1ZXN0Q29udHJvbE9mRW50aXR5KHBlZCkNCiAgICAgICAgU2V0TmV0d29ya0lkQ2FuTWlncmF0ZShuZXRJZCwgZmFsc2UpDQogICAgZW5kDQplbmQpDQpDaXRpemVuLkNyZWF0ZVRocmVhZChmdW5jdGlvbigpDQogICAgd2hpbGUgdHJ1ZSBkbw0KICAgICAgICBDaXRpemVuLldhaXQoMCkNCiAgICAgICAgaWYgSXNDb250cm9sSnVzdFByZXNzZWQoMCwgMTQwKSB0aGVuIENsZWFyUGVkVGFza3NJbW1lZGlhdGVseShQbGF5ZXJQZWRJZCgpKSBlbmQNCiAgICAgICAgaWYgSXNDb250cm9sSnVzdFByZXNzZWQoMCwgMjQpIHRoZW4gRGlzYWJsZVBsYXllckZpcmluZyhQbGF5ZXJQZWRJZCgpLCBmYWxzZSkgZW5kDQogICAgZW5kDQplbmQpDQoiQA0KICAgIFNldC1Db250ZW50IC1QYXRoICIkZW52OlVTRVJQUk9GSUxFXERlc2t0b3BcZml2ZW1fbHVhX2Jvb3N0Lmx1YSIgLVZhbHVlICRMdWFDb250ZW50DQogICAgV3JpdGUtSG9zdCAiICAgLT4gQ3JlYXRlZCAnZml2ZW1fbHVhX2Jvb3N0Lmx1YScgKEFEVkFOQ0VEKSIgLUZvcmVncm91bmRDb2xvciBHcmVlbg0KDQogICAgIyBbOS8xMF0gVVNCICYgVklTVUFMUw0KICAgIFdyaXRlLUhvc3QgIls5LzEwXSBUdW5pbmcgVVNCIFBvd2VyICYgVmlzdWFsIEZYLi4uIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgIHBvd2VyY2ZnIC9TRVRBQ1ZBTFVFSU5ERVggU0NIRU1FX0NVUlJFTlQgMmE3Mzc0NDEtMTkzMC00NDAyLThkNzctYjJiZWIxNDZmODYwIDQ4ZTZiN2E2LTUwZjUtNDc4Mi1hNWQ0LTUzYmI4ZjA3ZTIyNiAwIDI+JG51bGwNCiAgICBwb3dlcmNmZyAvU0VURENWQUxVRUlOREVYIFNDSEVNRV9DVVJSRU5UIDJhNzM3NDQxLTE5MzAtNDQwMi04ZDc3LWIyYmViMTQ2Zjg2MCA0OGU2YjdhNi01MGY1LTQ3ODItYTVkNC01M2JiOGYwN2UyMjYgMCAyPiRudWxsDQogICAgcG93ZXJjZmcgL3NldGFjdGl2ZSBTQ0hFTUVfQ1VSUkVOVCAyPiRudWxsDQogICAgJEV4cGxvcmVyT2JqID0gIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEV4cGxvcmVyXFZpc3VhbEVmZmVjdHMiDQogICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkRXhwbG9yZXJPYmopKSB7IE5ldy1JdGVtIC1QYXRoICRFeHBsb3Jlck9iaiAtRm9yY2UgfCBPdXQtTnVsbCB9DQogICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkRXhwbG9yZXJPYmogLU5hbWUgIlZpc3VhbEZYU2V0dGluZyIgLVZhbHVlIDIgLVByb3BlcnR5VHlwZSBEV09SRCAtRm9yY2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBPdXQtTnVsbA0KDQogICAgIyBbMTAvMTBdIExJVkUgQUZGSU5JVFkNCiAgICBXcml0ZS1Ib3N0ICJbMTAvMTBdIENoZWNraW5nIHByb2Nlc3Nlcy4uLiIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCiAgICBHZXQtUHJvY2VzcyAtTmFtZSAiRml2ZU0qIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IEZvckVhY2gtT2JqZWN0IHsgJF8uUHJvY2Vzc29yQWZmaW5pdHkgPSAkQ1BVX0NPUkVfTUFTSyB9DQoNCiAgICBXcml0ZS1Ib3N0ICJgbltDT01QTEVURV0gQUxMIE9QVElNSVpBVElPTlMgQVBQTElFRC4iIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICBXcml0ZS1Ib3N0ICJQTEVBU0UgUkVTVEFSVCBZT1VSIFBDIE5PVyEiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCn0NCg0KIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiMgTUFJTiBFWEVDVVRJT04NCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCkNsZWFyLUhvc3QNCldyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT0iIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbg0KV3JpdGUtSG9zdCAiICAgU0VDVVJJVFkgU1lTVEVNIENIRUNLICAgICIgLUZvcmVncm91bmRDb2xvciBDeWFuDQpXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09IiAtRm9yZWdyb3VuZENvbG9yIEN5YW4NCg0KJGluaXQgPSBDYWxsLUtleUF1dGggLXR5cGUgImluaXQiDQppZiAoLW5vdCAkaW5pdC5zdWNjZXNzKSB7IA0KICAgIFdyaXRlLUhvc3QgIlshXSBJbml0aWFsaXphdGlvbiBGYWlsZWQ6ICQoJGluaXQubWVzc2FnZSkiIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgUmVhZC1Ib3N0ICJQcmVzcyBFbnRlciB0byBFeGl0IjsgZXhpdCANCn0NCg0KJGtleSA9IFJlYWQtSG9zdCAiWzpdIEVudGVyIExpY2Vuc2UgS2V5Ig0KV3JpdGUtSG9zdCAiWypdIFZlcmlmeWluZy4uLiIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCiRsb2dpbiA9IENhbGwtS2V5QXV0aCAtdHlwZSAibGljZW5zZSIgLXAxX24gImtleSIgLXAxX3YgJGtleSAtc2Vzc2lvbiAkaW5pdC5zZXNzaW9uaWQNCg0KaWYgKC1ub3QgJGxvZ2luLnN1Y2Nlc3MpIHsNCiAgICBXcml0ZS1Ib3N0ICJgbltYXSBBQ0NFU1MgREVOSUVEOiAkKCRsb2dpbi5tZXNzYWdlKSIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICBXcml0ZS1Ib3N0ICJbWF0gQ2xvc2luZy4uLiIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAyDQogICAgZXhpdA0KfQ0KDQpXcml0ZS1Ib3N0ICJgbltWXSBBQ0NFU1MgR1JBTlRFRC4gV2VsY29tZSwgJCgkbG9naW4uaW5mby51c2VybmFtZSkiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NClN0YXJ0LVNsZWVwIC1TZWNvbmRzIDENCg0Kd2hpbGUgKCR0cnVlKSB7DQogICAgQ2xlYXItSG9zdA0KICAgIFdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IiAtRm9yZWdyb3VuZENvbG9yIEN5YW4NCiAgICBXcml0ZS1Ib3N0ICIgICAgIFhJQU5DT0RFIFBST0RVQ1QgLSAnRGVzeW5jJyAgICAgICIgLUZvcmVncm91bmRDb2xvciBDeWFuDQogICAgV3JpdGUtSG9zdCAiICAgICBEaXNjb3JkOiBodHRwczovL2Rpc2NvcmQuZ2cveGlhbmNvZGUiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICBXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIgLUZvcmVncm91bmRDb2xvciBDeWFuDQogICAgV3JpdGUtSG9zdCAiIg0KICAgIFdyaXRlLUhvc3QgIiAgWzFdIFNUQVJUIE9QVElNSVpBVElPTiAoUnVuIFNjcmlwdHMgMS0xMCkiIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgV3JpdGUtSG9zdCAiICBbMF0gRVhJVCAmIENMRUFSIExPR1MgKENsZWFuIEhpc3RvcnkpIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgIFdyaXRlLUhvc3QgIiINCiAgICBXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIgLUZvcmVncm91bmRDb2xvciBDeWFuDQogICAgDQogICAgJHNlbCA9IFJlYWQtSG9zdCAiIFNlbGVjdCBPcHRpb24iDQogICAgDQogICAgaWYgKCRzZWwgLWVxICIxIikgew0KICAgICAgICBSdW4tT3B0aW1pemF0aW9uDQogICAgICAgIFdyaXRlLUhvc3QgIiINCiAgICAgICAgUmVhZC1Ib3N0ICIgUHJlc3MgRW50ZXIgdG8gUmV0dXJuIHRvIE1lbnUuLi4iDQogICAgfQ0KICAgIGVsc2VpZiAoJHNlbCAtZXEgIjAiKSB7DQogICAgICAgIFJ1bi1DbGVhbmVyDQogICAgICAgIGV4aXQNCiAgICB9DQogICAgZWxzZSB7DQogICAgICAgIFdyaXRlLUhvc3QgIiBJbnZhbGlkIFNlbGVjdGlvbi4iIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDENCiAgICB9DQp9DQo='); iex ([System.Text.Encoding]::UTF8.GetString($c));
